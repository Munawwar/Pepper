!function(e){"object"==typeof module&&module.exports?module.exports=e():window.Pepper=e()}((function(){var e=Array.prototype;function t(t,n){return e.slice.call(t,n)}function n(t,n,r){return e.forEach.call(t,n,r)}function r(e){return Object.keys(e).filter((function(e){return"constructor"!==e}))}function o(e){return t(arguments,1).forEach((function(t){r(t).forEach((function(n){e[n]=t[n]}))})),e}function a(e){e=e||{};for(var t=1;t<arguments.length;t+=1){var n=arguments[t];if(n&&"object"==typeof c)for(var r=r(n),o=1;o<r.length;o+=1){var i=r[o],c=n[i];e[i]="object"==typeof c&&null!==c?a(e[i],c):c}}return e}function i(e){if(e.tagName.indexOf("-")>0)return!0;var t=e.getAttribute("is");return t&&t.indexOf("-")>0}function c(e,t){for(var n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT),r=n.currentNode;r;)i(r)?r=n.nextSibling():(t(r),r=n.nextNode())}function u(e,t){var n,r=t.get(e);return r||(r=e.nodeType+":"+(1===e.nodeType?i(e)?(n=e).outerHTML.slice(0,-(n.innerHTML.length+n.tagName.length+4))+"/>":e.outerHTML:e.nodeValue),t.set(e,r)),r}function f(e,r,o,a){if(e.length){var c=new WeakMap,d={};e.forEach((function(e){var t=u(e,c);d[t]=d[t]||{u:[],n2l:new Map,l2n:new Map},d[t].u.push(e)}));var s=0,l={};if(r.forEach((function(e){var t=u(e,c),n=d[t],r=!1;if(n){var o=n.u.shift();o&&(n.n2l.set(o,e),n.l2n.set(e,o),r=!0,s++)}r||1!==e.nodeType||(l[e.nodeName]=l[e.nodeName]||[],l[e.nodeName].push(e))})),s===e.length&&r.length>e.length)for(var h=r.length-1;h>=0;h--){var v=r[h],p=u(v,c);d[p]&&d[p].l2n.has(v)||(o.removeChild(v),r.splice(h,1))}var m=t(o.childNodes).indexOf(a)+1,b=new Set;e.forEach((function(e,r){var a=u(e,c),s=d[a].n2l.get(e),h=o.childNodes[m+r];if(s)return b.add(s),void(h!==s&&o.insertBefore(s,h));var v=e.nodeName;if(1!==e.nodeType||!l[v]||!l[v].length)return b.add(e),void o.insertBefore(e,h);var p=e,g=l[e.nodeName].shift();b.add(g),h!==g&&o.insertBefore(g,h),function(e,t){n(t.attributes,(function(n){e.attributes.getNamedItem(n.name)||t.attributes.removeNamedItem(n.name)})),n(e.attributes,(function(e){t.getAttribute(e.name)!==e.value&&t.setAttribute(e.name,e.value)}))}(p,g),i(p)||f(t(p.childNodes),t(g.childNodes),g)})),r.forEach((function(e){b.has(e)||o.removeChild(e)}))}else r.forEach((e=>o.removeChild(e)))}var d=function(e){var t=this;t._data="object"==typeof e.data&&e.data||{};var n=e.mount,r=e.hydrate;delete e.data,delete e.mount,delete e.hydrate,o(t,e),Object.defineProperty(t,"data",{configurable:!1,set:function(e){t._data=e,t.render()},get:function(){return t._data}}),r?t.hydrate():n&&t.mount()},s=new WeakMap;return(d.Store=function(e){var t=this;t._data=e||{},t._subscribers=[],Object.defineProperty(this,"data",{configurable:!1,set:function(e){if("object"==typeof e){var n=[].concat(r(e).filter((function(n){return t._data[n]!==e[n]})),r(t._data).filter((function(t){return!(t in e)})));t._data=e,t.notify(n)}},get:function(){return t._data}})}).prototype={data:{},notify:function(e){var t=e.reduce((function(e,t){return e[t]=1,e}),{});this._subscribers.forEach((function(e){var n=e.props.filter((function(e){return t[e]}));n.length&&e.callback.call(e.context,n)}))},subscribe:function(e,t,n){if("function"==typeof t&&Array.isArray(e)){this._subscribers.some((function(e){return e.callback===t&&(void 0===n||n===e.context)}))||this._subscribers.push({props:e,callback:t,context:n})}},unsubscribe:function(e,t){this._subscribers=this._subscribers.filter((function(n){return!(n.callback===e&&(void 0===t||t===n.context))}))},assign:function(e){var t=this;if("object"==typeof e){var n=r(e).filter((function(n){return t._data[n]!==e[n]}));o(t._data,e),t.notify(n)}}},d.prototype={_data:null,target:null,connect:{},getHtml:function(){return""},assign:function(){var e=t(arguments);o.apply(null,[this.data].concat(e)),this.render()},merge:function(e){a(this.data,e),this.render()},handleEvent:function(e){!function(e,t){var n=t.currentTarget,r=(s.get(n)||{})[t.type];r&&r.call(e,t)}(this,e)},toString:function(){var e=this,t=e.connect,n=t&&t.store&&t.store._data||{},r=o((t&&t.props||[]).reduce((function(e,t){return e[t]=n[t],e}),{}),e.data);return e.getHtml(r)},render:function(){var e=this,n=e.el,r=document.activeElement.id;n&&c(n,(function(t){var n=t.getAttribute("ref");n&&e[n]instanceof Node&&delete e[n],s.has(t)&&function(e,t){Object.keys(s.get(e)||{}).forEach((function(n){e.removeEventListener(n,t)})),s.delete(e)}(t,e)}));var o=function(e){var t;if("content"in document.createElement("template")){var n=document.createElement("template");n.innerHTML=e,t=n.content}else window.jQuery?(t=document.createDocumentFragment(),jQuery.parseHTML(e).forEach((function(e){t.appendChild(e)}))):t=window.parseHTML(e);for(var r=t.querySelectorAll("script"),o=0;o<r.length;o+=1)t.removeChild(r[o]);return t}(e.toString()).firstElementChild;if(n){var a=n.parentNode,i=t(a.childNodes).indexOf(n);f([o],[n],a,n.previousSibling),e.el=a.childNodes[i]}else e.el=o;if(r){var u=document.getElementById(r);u&&u.focus()}e.domHydrate()},domHydrate:function(){var e=this;e.el.pepperInstance=e,c(e.el,(function(t){var r=t.getAttribute("ref");r&&(e[r]=t),n(t.attributes,(function(n){if(n.name.startsWith("on-")){var r=n.name.replace(/on-/,"");!function(e,t,n,r){if(r){var o=s.get(e)||{};o[n]=r,s.set(e,o),e.addEventListener(n,t)}}(t,e,r,e[n.value])}}))}))},mount:function(e=!1){var t=this,n=t.connect;n&&n.store&&n.store.subscribe(n.props,t.render,t);var r=t.target;"string"==typeof r&&(r=document.querySelector(r)),t.el&&r===t.el||r&&r.parentNode&&(t.el=r,e?t.domHydrate():t.render())},hydrate:function(e){arguments.length>0&&e&&"object"==typeof e&&(this._data=e),this.mount(!0)},append:function(e){var t=this,n=t.connect;n&&n.store&&n.store.subscribe(n.props,t.render,t),t.el||t.render(),e.appendChild(t.el)},unmount:function(){var e=this,t=e.connect;t&&t.store&&t.store.unsubscribe(e.render,e),e.el.parentNode.removeChild(e.el)}},d}));